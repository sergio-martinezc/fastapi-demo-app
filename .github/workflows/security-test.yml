name: Prisma Cloud image scan
on: [push]
jobs: 
  twsitcli_job:

     runs-on: ubuntu-latest
     steps:
       - name: Twistcli image scan
         id: scan
         uses: PaloAltoNetworks/prisma-cloud-scan@v1.6.8
         with:
           pcc_console_url: https://us-east1.cloud.twistlock.com/us-2-158320372
           pcc_user: 323acdd4-4242-4078-a83c-7bac7101218b
           pcc_pass: Axg5ud0uW+zetdGJL/sz5BmoDMU=
           image_name: smartinezc/fastapi-demo-app
           twistcli_debug: true

#name: Checkov
#on: [push]
#jobs:
  checkov:

    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Set up Python 3.8
        uses: actions/setup-python@v4
        with:
          python-version: 3.8
      - name: Test with Checkov
        id: checkov
        uses: bridgecrewio/checkov-action@master
        with:
          directory: . 
          api-key: 132ea96b-66cf-4c62-ae33-95772e68ff1a::0EmoqoGE2+gc+kentowADdV/B50=
          prisma-api-url: https://api2.prismacloud.io
          output_format: cli
          use_enforcement_rules: True
          soft_fail: True
